@page "/register/"
@model RegisterModel
@{
    ViewData["Title"] = "ĐĂNG KÝ TÀI KHOẢN";
}

<style>
    /* CSS đơn giản để hỗ trợ giao diện mẫu */
    .social-btn-container { display: flex; gap: 10px; margin-top: 10px; }
    .social-button { flex: 1; border-radius: 5px; font-weight: bold; }
    .tiktok { background-color: #000; color: #fff; border: 1px solid #000; }
    .facebook { background-color: #3b5998; color: #fff; border: 1px solid #3b5998; }
    .twitter { background-color: #1da1f2; color: #fff; border: 1px solid #1da1f2; }
    .social-button:hover { opacity: 0.9; color: #fff; }
</style>

<div class="row justify-content-center">
    <div class="col-md-6">
        <form id="signup-form" asp-route-returnUrl="@Model.ReturnUrl" method="post">
            <h2 class="text-center">Tạo tài khoản mới</h2>
            <hr />
            
            <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

            <div class="form-floating mb-3">
                <input asp-for="Input.UserName" class="form-control" id="name" placeholder="Họ và tên" />
                <label asp-for="Input.UserName">Họ và tên</label>
                <span asp-validation-for="Input.UserName" class="text-danger"></span>
            </div>

            <div class="form-floating mb-3">
                <input asp-for="Input.Email" class="form-control" id="email" autocomplete="username" placeholder="name@example.com" />
                <label asp-for="Input.Email">Email</label>
                <span asp-validation-for="Input.Email" class="text-danger"></span>
            </div>

            <div class="form-floating mb-3 position-relative">
                <input asp-for="Input.Password" class="form-control" id="password" autocomplete="new-password" placeholder="password" />
                <label asp-for="Input.Password">Mật khẩu</label>
                <span asp-validation-for="Input.Password" class="text-danger"></span>
            </div>

            <div class="form-floating mb-3">
                <input asp-for="Input.ConfirmPassword" class="form-control" id="confirm-password" autocomplete="new-password" placeholder="password" />
                <label asp-for="Input.ConfirmPassword">Nhập lại mật khẩu</label>
                <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
            </div>
            
            <div id="password-error" class="text-danger mb-2" style="display:none; font-weight:bold;"></div>

            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="agree">
                <label class="form-check-label" for="agree">Tôi đồng ý với điều khoản</label>
            </div>

            <div id="captcha-container" class="mb-3" style="display:none;">
                <div class="g-recaptcha" data-sitekey="YOUR_SITE_KEY"></div>
            </div>

            <button id="registerSubmit" type="submit" class="w-100 btn btn-lg btn-primary">Đăng ký</button>
            
            <div class="text-center mt-3">
                <a href="#" id="back-to-home">Quay về trang chủ</a>
            </div>
        </form>

        <div class="mt-4">
            <section>
                <h3 class="text-center h5">Hoặc đăng ký bằng</h3>
                <hr />
                @{
                    if ((Model.ExternalLogins?.Count ?? 0) == 0)
                    {
                        <div class="text-center">
                            <p>Chưa cấu hình đăng nhập mạng xã hội.</p>
                        </div>
                    }
                    else
                    {
                        <form id="external-account" asp-page="./ExternalLogin" asp-route-returnUrl="@Model.ReturnUrl" method="post" class="form-horizontal">
                            <div class="social-btn-container">
                                @foreach (var provider in Model.ExternalLogins!)
                                {
                                    // Tạo class CSS dựa trên tên provider để giống mẫu JS (facebook, twitter...)
                                    var btnClass = provider.Name.ToLower(); 
                                    <button type="submit" class="btn social-button @btnClass" name="provider" value="@provider.Name" title="Log in using your @provider.DisplayName account">
                                        @provider.DisplayName
                                    </button>
                                }
                            </div>
                        </form>
                    }
                }
            </section>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}